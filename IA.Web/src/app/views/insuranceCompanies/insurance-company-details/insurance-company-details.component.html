<div class="width-100">
  <div class="col-md-12">
    <button type="button" mat-raised-button color="primary" (click)="back()" class="button-back outline-unset"><i
        class="material-icons reply">reply</i>
      {{'BACK' | translate}}</button>
  </div>
  <form #form="ngForm" (ngSubmit)="add(form)" class="m-t-20">
    <div class="row">
      <div class="col-md-12">
        <mat-card>
          <mat-card-content>
            <mat-card-title>{{'INSURANCE_COMPANY_INFO' | translate}}</mat-card-title>
            <br>
            <div class="row">
              <div class="col-md-12">
                <mat-form-field class="example-full-width">
                  <input type="text" required matInput #Name="ngModel" [(ngModel)]="insurance.Name" name="Name"
                    placeholder="{{'INSURANCE_COMPANY_NAME' | translate}}">
                </mat-form-field>
                <div *ngFor="let err of validationErrors?.Name">
                  <span  class="help-block text-danger">{{err}}</span>
                </div>
              </div>
            </div>
                <div class="row">
              <div class="col-md-12">
            <mat-form-field>
              <input type="text" required matInput #Label="ngModel"
                [(ngModel)]="insurance.Label" name="Label" placeholder="{{'LABEL' | translate}}">
            </mat-form-field>
            <div *ngFor="let err of validationErrors?.Label">
              <span class="help-block text-danger">{{err}}</span>
            </div>
              </div>
            </div>
      <div class="row">
        <div class="col-md-12">
          <button  type="submit"  class="outline-unset" mat-raised-button color="primary"
          name=add><i class="material-icons check">check</i>
          {{'SAVE' | translate}}</button>
        </div>
      </div>
    </mat-card-content>
     </mat-card>
      </div>
    </div>
  </form>
  <form *ngIf="showForm" #formMainOffice="ngForm" (ngSubmit)="addMainOffice(formMainOffice)">
    <div class="row p-b-0">
      <div class="col-md-12">
        <mat-card>
          <mat-card-content>
            <mat-card-title>{{'ADD_MAIN_OFFICE' | translate}}
              <button type="button" *ngIf="companyInsuranceMainOffices.length > 0"  [disabled]="mainOffices.length == 0" mat-raised-button color="primary" class="outline-unset backgroung-color-dark-orange" (click)="addAllMainOffices()">
                {{'ADD_EXISTS_MAIN_OFFICES' | translate}}
              </button>
              <button type="button" *ngIf="companyInsuranceMainOffices.length == 0" mat-raised-button color="primary" class="outline-unset backgroung-color-dark-orange" (click)="addAllMainOffices()">
                {{'ADD_ALL_MAIN_OFFICES' | translate}}
              </button>
            </mat-card-title>
            <mat-form-field>
              <mat-select [disabled]="mainOffices.length == 0" required placeholder="{{'MAIN_OFFICE_NAME' | translate}}" name="MainOffice" id="MainOffice"
                #MainOffice="ngModel" [(ngModel)]="companyInsuranceMainOffice.MainOfficeId">
                <mat-option *ngFor="let mainOffice of mainOffices" [value]="mainOffice.Id">
                  {{ mainOffice.Name }}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <div *ngFor="let err of validationErrors?.MainOffice">
              <span class="help-block text-danger">{{err}}</span>
            </div>
            <mat-form-field class="example-full-width">
              <input [disabled]="mainOffices.length == 0" type="number" step="0.1" min="0"
                onkeypress="return event.charCode >= 48 || event.charCode == 44 || event.charCode == 46" required matInput
                #Netto="ngModel" [(ngModel)]="companyInsuranceMainOffice.Netto" name="Netto" placeholder="{{'NETTO' | translate}}">
            </mat-form-field>
            <div *ngFor="let err of validationErrors?.Netto">
              <span class="help-block text-danger">{{err}}</span>
            </div>
            <div class="row">
              <div class="col-md-12">
                <button [disabled]="mainOffices.length == 0" type="submit" class="outline-unset" mat-raised-button color="primary" name=add><i
                    class="material-icons check">check</i>
                  {{'SAVE' | translate}}</button>
              </div>
            </div>
          </mat-card-content>
        </mat-card>
      </div>
    </div>
  </form>
  <div *ngIf="showTable && companyInsuranceMainOffices.length != 0" class="row" >
    <div class="col-md-12">
      <mat-card>
        <mat-card-content>
          <mat-card-title>{{'MAIN_OFFICES_PREVIEW' | translate}}</mat-card-title>
          <br>
          <p-table #dt [value]="companyInsuranceMainOffices" [responsive]="true" [paginator]="true" [rows]="5"
          [rowsPerPageOptions]="[5,10,20,30]">
            <ng-template pTemplate="header">
              <tr>
                <th class="text-right">
                  {{'MAIN_OFFICE_NAME' | translate}}
                </th>
                <th class="text-right">
                  {{'NETTO' | translate}}
                </th>
                <th class="text-right">
                  {{'DETAILS' | translate}}
                </th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-x>
              <tr>
                <td class="text-right"><span
                    class="ui-column-title text-left float-left">{{ 'MAIN_OFFICE_NAME' | translate }}</span><span
                    class="float-right">{{x.MainOfficeName}}</span>
                </td>
                <td pEditableColumn class="text-right">
                  <i class="icon line-height-25 margins float-right">edit</i>
                  <span class="ui-column-title text-left float-left">{{ 'NETTO' | translate }}</span>
                  <p-cellEditor>
                    <ng-template pTemplate="input">
                      <input pInput type="number" min="0" class="input-style float-right width-20-percent" [(ngModel)]="x.Netto" id="mainOfficeNetto"
                      name="mainOfficeNetto" (keydown.enter)="editMainOfficeNetto(x)" (blur)="editMainOfficeNetto(x)">
                    </ng-template>
                    <ng-template pTemplate="output" class="text-right float-right">
                      <span class="text-right float-right text-pre-wrap" (mousedown)="tooltip.hide()" #tooltip="matTooltip" matTooltip="{{x.Netto}}">
                        {{x.Netto || '-'}}
                      </span>
                    </ng-template>
                  </p-cellEditor>
                  </td>
                <td class="text-right"><i
                    class="ti-trash text-danger m-r-7-negative" deleteConfirmation
                    [deleteItemId]="x.MainOfficeId" (onDelete)="onDelete($event)"><span
                      class="icon-text">{{'DELETE' | translate}}</span></i></td>
              </tr>
            </ng-template>
            <ng-template pTemplate="emptymessage">
              <tr>
                  <td [attr.colspan]="3" class="text-center">
                      <strong>{{'NO_ADDED_MAIN_OFFICES' | translate}}</strong>
                  </td>
              </tr>
          </ng-template>
          </p-table>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>
