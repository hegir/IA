<div class="width-99">
  <div class="col-md-12">
    <button type="button" mat-raised-button color="primary" class="button-back" (click)="back()"><i
        class="material-icons reply">reply</i>
      {{'BACK' | translate}}</button>
  </div>
</div>

<form class="m-t-20" #form="ngForm" autocomplete="off">
  <div class="row">
    <div class="col-md-12">
      <mat-card>
        <mat-card-content>
          <button type="button" *ngxPermissionsOnly="['P_ENABLE_FIELDS']" mat-raised-button class="float-right backgroud-color-orange outline-unset" color="primary" (click)="enableFieldsUpdate()">
            <i *ngIf="!enableFieldsForUpdate" class="material-icons vertical-align">lock</i>
            <i *ngIf="enableFieldsForUpdate" class="material-icons vertical-align">lock_open</i>
          {{'ENABLE_FIELDS' | translate}}
        </button>
          <mat-card-title>{{'POLICY' | translate}}</mat-card-title>



          <mat-horizontal-stepper #stepper labelPosition="bottom" [linear]="true" (selectionChange)="stepChanged($event)">
            <mat-step completed="step1">
              <ng-template matStepLabel>{{'POLICY_AND_GREEN_CARD_DETAILS' | translate}}</ng-template>

              <mat-form-field *ngIf="!isAdmin">
                <mat-select [disabled]="!enableFieldsForUpdate || disableInsurance" required [(ngModel)]="policy.MainOfficeId"
                  name="MainOffice" id="MainOffice" placeholder="{{'MAIN_OFFICE' | translate}}">
                  <mat-option *ngFor="let mainOffice of userMainOffices" [value]="mainOffice.MainOfficeId">
                    {{mainOffice.MainOfficeName}}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field *ngIf="!isNewType && isAdmin">
                <input [disabled]="!isNewType" id="AdminMainOffice"  matInput
                 #MainOffice="ngModel" [(ngModel)]="mainOffice.Name"
                name="AdminMainOffice" placeholder="{{'MAIN_OFFICE' | translate}}">
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.MainOffice">
                <span class="help-block text-danger">{{ err }}</span>
              </div>

              <mat-form-field class="example-full-width">
                <mat-select required [disabled]="!enableFieldsForUpdate || disableInsurance" required
                  (selectionChange)="onSelectedInsuranceChange($event)" [(ngModel)]="selectedInsurance" id="Insurance"
                  name="Insurance" placeholder="{{'INSURANCE_COMPANY' | translate}}">
                  <mat-option *ngFor="let insurance of insuranceCompanies" [value]="insurance">
                    {{insurance.Name}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.Insurance">
                <span class="help-block text-danger">{{ err }}</span>
              </div>

              <mat-form-field *ngIf="!showDunavInsuranceNumbers">
                <mat-select required [disabled]="!enableFieldsForUpdate || disablePolicyNumbers" required
                  [(ngModel)]="selectedPolicyNumber" name="Number" id="PolicyNumber"
                  placeholder="{{'POLICY_NUMBER' | translate}}">
                  <mat-option *ngFor="let number of activePolicyNumbers" [value]="number">
                    {{number.Number}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.Number">
                <span class="help-block text-danger">{{ err }}</span>
              </div>

              <mat-form-field *ngIf="showDunavInsuranceNumbers">
                <mat-select required [disabled]="!enableFieldsForUpdate || disablePolicyNumbers"
                  [(ngModel)]="selectedPolicyNumber" name="PolicyNumberForm" id="PolicyNumberForm"
                  placeholder="{{'POLICY_NUMBER_FORM' | translate}}">
                  <mat-option *ngFor="let number of activePolicyNumbers" [value]="number">
                    {{number.Number}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.PolicyNumberForm">
                <span class="help-block text-danger">{{ err }}</span>
              </div>

              <mat-form-field *ngIf="showDunavInsuranceNumbers">
                <input required onkeypress="return (event.charCode != 32)" oninput="validity.valid||(value='');"
                  [disabled]="!enableFieldsForUpdate" type="text" matInput #PolicyNumberFormData="ngModel"
                  [(ngModel)]="policy.PolicyNumberFormData" name="PolicyNumberFormData"
                  placeholder="{{'POLICY_NUMBER' | translate}}">
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.PolicyNumberFormData">
                <span class="help-block text-danger">{{err}}</span>
              </div>

              <arni-autocomplete required [disabled]="!enableFieldsForUpdate" #insuranceTypesComponent displayField="LabelName"
                name="InsuranceType" id="InsuranceType" (onChange)="onInsuranceTypeChange($event)"
                [items]="insuranceTypes" [selectedItem]="selectedInsuranceType"
                placeholder="{{'INSURANCE_TYPE' | translate}} *">
              </arni-autocomplete>
              <div *ngFor="let err of validationErrors?.InsuranceType">
                <span class="help-block text-danger">{{ err }}</span>
              </div>

              <mat-form-field *ngIf="policy.InsuranceTypeId==16">
                <mat-select [disabled]="!enableFieldsForUpdate" placeholder="{{'REGISTRATION_TYPE' | translate}}" type="text"
                  #RegistrationType="ngModel" [(ngModel)]="policy.RegistrationType" name="RegistrationType" id="RegistrationType">
                  <mat-option [value]="null">BEZ VRSTE REGISTRACIJE</mat-option>
                  <mat-option *ngFor="let enum of RegistrationTypes" [value]="enum.value">
                    {{enum.name | uppercase | translate}}
                  </mat-option>
                </mat-select>
              </mat-form-field>


            <mat-form-field class="example-full-width">
              <mat-select required [disabled]="!enableFieldsForUpdate" required
                (selectionChange)="onSelectedGreenCard($event)" [(ngModel)]="selectedGreenCard" id="GreenCard"
                name="GreenCard" placeholder="{{'GREEN_CARD' | translate}}">
                <mat-option *ngFor="let greenCard of greenCardsForAgent" [value]="greenCard">
                  {{greenCard.Number}}
                </mat-option>
              </mat-select>
            </mat-form-field>
            <div *ngFor="let err of validationErrors?.GreenCard">
              <span class="help-block text-danger">{{ err }}</span>
            </div>

            <div fxLayout="row wrap">
              <div fxFlex.gt-sm="100" fxFlex.gt-xs="100" fxFlex="100">
                <mat-form-field>
                  <input required [disabled]="!enableFieldsForUpdate" (click)="showPicker(createdDatePicker)" matInput
                    onkeypress="return (event.charCode <= 65 && event.charCode >= 90) || (event.charCode <= 97 && event.charCode>=122)"
                    oninput="validity.valid||(value='');" [matDatepicker]="createdDatePicker"
                    #Created="ngModel" [(ngModel)]="policy.Created" name="CreatedDate"
                    placeholder="{{'MADE_DATE' | translate}}">
                  <mat-datepicker-toggle matSuffix [for]="createdDatePicker" (monthSelected)="chosenMonthHandlerCreated(createdDatePicker)"></mat-datepicker-toggle>
                  <mat-datepicker #createdDatePicker></mat-datepicker>
                </mat-form-field>
              </div>
            </div>
            <div *ngFor="let err of validationErrors?.CreatedDate">
              <span class="help-block text-danger"> {{ err }}</span>
            </div>

              <div fxLayout="row wrap">
                <div fxFlex.gt-sm="100" fxFlex.gt-xs="100" fxFlex="100">
                  <mat-form-field>
                    <input required [disabled]="!enableFieldsForUpdate" id="beginDate" (dateChange)="handleDOBChange($event)"
                      onkeypress="return (event.charCode <= 65 && event.charCode >= 90) || (event.charCode <= 97 && event.charCode>=122)"
                      oninput="validity.valid||(value='');" (click)="showPicker(beginPicker)" matInput
                      [matDatepicker]="beginPicker" #PolicyBegin="ngModel" [(ngModel)]="policy.PolicyBegin"
                      name="PolicyBegin" placeholder="{{'BEGIN_DATE' | translate}}">
                    <mat-datepicker-toggle matSuffix [for]="beginPicker" (monthSelected)="chosenMonthHandlerBegin(beginPicker)"></mat-datepicker-toggle>
                    <mat-datepicker #beginPicker></mat-datepicker>
                  </mat-form-field>
                </div>
              </div>
              <div *ngFor="let err of validationErrors?.PolicyBegin">
                <span class="help-block text-danger"> {{ err }}</span>
              </div>

              <div fxLayout="row wrap">
                <div fxFlex.gt-sm="100" fxFlex.gt-xs="100" fxFlex="100">
                  <mat-form-field>
                    <input required [disabled]="!enableFieldsForUpdate" (click)="showPicker(expirationDatePicker)" matInput
                      onkeypress="return (event.charCode <= 65 && event.charCode >= 90) || (event.charCode <= 97 && event.charCode>=122)"
                      oninput="validity.valid||(value='');" [matDatepicker]="expirationDatePicker"
                      #PolicyExpiration="ngModel" [(ngModel)]="policy.PolicyExpiration" name="PolicyExpiration"
                      placeholder="{{'DATE_OF_EXPIRATION' | translate}}">
                    <mat-datepicker-toggle matSuffix [for]="expirationDatePicker" (monthSelected)="chosenMonthHandlerExpiration(expirationDatePicker)"></mat-datepicker-toggle>
                    <mat-datepicker #expirationDatePicker></mat-datepicker>
                  </mat-form-field>
                </div>
              </div>
              <div *ngFor="let err of validationErrors?.PolicyExpiration">
                <span class="help-block text-danger"> {{ err }}</span>
              </div>

              <br>
              <div>
                <button type="button" (click)="validatePolicy()" class="btn btn-primary float-right"
                  mat-button><i class="material-icons fa fa-share"></i></button>
              </div>
            </mat-step>



            <mat-step completed="step2">
              <ng-template matStepLabel>{{'POLICY_HOLDER_DETAILS' | translate}}</ng-template>

              <mat-form-field>
                <mat-select required
                  placeholder="{{'POLICY_HOLDER_TYPE' | translate}}" type="text" #PolicyHolderType="ngModel"
                  [(ngModel)]="policyHolder.PolicyHolderType" name="PolicyHolderType" id="policyHolderType" (selectionChange)="getPolicyHolders($event)">
                  <mat-option *ngFor="let enum of policyHolderType" [value]="enum.value">
                    {{enum.name | uppercase | translate}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.PolicyHolderType">
                <span class="help-block text-danger">{{err}}</span>
              </div>


              <arni-autocomplete [disabled]="!enableFieldsForUpdate" #policyHoldersComponent displayField="DisplayName"
              name="PolicyHolder" id="PolicyHolder" (onChange)="onSelectedPolicyHolderChanged($event)"
              [items]="policyHolders" [selectedItem]="selectedPolicyHolder"
              placeholder="{{'POLICY_HOLDER_FIRST_NAME_LAST_NAME_CITY' | translate}} *" (change)="addFullName($event)">
            </arni-autocomplete>
            <div *ngFor="let err of validationErrors?.PolicyHolder">
              <span class="help-block text-danger"> {{ err }}</span>
            </div>


            <mat-form-field class="example-full-width" *ngIf="policyHolder.PolicyHolderType == 1">
              <input required
                [disabled]="!enableFieldsForUpdate" type="text" matInput #CompanyName="ngModel"
                [(ngModel)]="policyHolder.CompanyName" name="CompanyName" value="policyHolder.CompanyName"
                placeholder="{{'COMPANYNAME' | translate}}">
            </mat-form-field>
            <div  *ngFor="let err of validationErrors?.CompanyName">
              <span class="help-block text-danger">{{err}}</span></div>

              <mat-form-field class="example-full-width" *ngIf="policyHolder.PolicyHolderType == 0">
                <input required
                  [disabled]="!enableFieldsForUpdate" type="text" matInput #FirstName="ngModel"
                  [(ngModel)]="policyHolder.FirstName" name="FirstName" value="policyHolder.FirstName"
                  placeholder="{{'FIRST_NAME' | translate}}">
              </mat-form-field>
              <div  *ngFor="let err of validationErrors?.FirstName">
                <span class="help-block text-danger">{{err}}</span>
              </div>

              <mat-form-field class="example-full-width" *ngIf="policyHolder.PolicyHolderType == 0">
                <input required
                  type="text" matInput #LastName="ngModel" [(ngModel)]="policyHolder.LastName" name="LastName"
                  value="policyHolder.LastName" placeholder="{{'LAST_NAME' | translate}}">
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.LastName">
                <span class="help-block text-danger">{{err}}</span>
              </div>

              <mat-form-field class="example-full-width" *ngIf="policyHolder.PolicyHolderType == 0">
                <input required onkeypress="return (event.charCode >= 47 && event.charCode <= 57)"
                  maxlength="13" [disabled]="!enableFieldsForUpdate" type="text" matInput
                  #PersonalIdentificationNumber="ngModel" [(ngModel)]="policyHolder.PersonalIdentificationNumber"
                  name="PersonalIdentificationNumber" placeholder="{{'PERSONAL_IDENTIFICATION_NUMBER' | translate}}"
                  >
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.PersonalIdentificationNumber">
                <span class="help-block text-danger">{{err}}</span>
              </div>

              <mat-form-field class="example-full-width" *ngIf="policyHolder.PolicyHolderType == 1">
                <input required onkeypress="return (event.charCode >= 47 && event.charCode <= 57)"
                  maxlength="13" [disabled]="!enableFieldsForUpdate" type="text" matInput
                  #PersonalIdentificationNumber="ngModel" [(ngModel)]="policyHolder.PersonalIdentificationNumber"
                  name="PersonalIdentificationNumber" placeholder="{{'ID_NUMBER' | translate}}"
                  >
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.PersonalIdentificationNumber">
                <span class="help-block text-danger">{{err}}</span>
              </div>

              <mat-form-field class="example-full-width">
                <input required type="text" matInput #Address="ngModel" [(ngModel)]="policyHolder.Address"
                  name="Address" placeholder="{{'ADDRESS' | translate}}">
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.Address">
                <span class="help-block text-danger">{{err}}</span>
              </div>

              <arni-autocomplete #cityComponent displayField="CityNameMunicipalityCode" name="City"
                id="City" (onChange)="onSelectedCityChanged($event)" [items]="cities" [selectedItem]="selectedCity"
                placeholder="{{'CITY_NAME' | translate}} *">
              </arni-autocomplete>
              <div *ngFor="let err of validationErrors?.City">
                <span class="help-block text-danger">{{err}}</span>
              </div>

              <br>
              <div>
                <button type="button" class=" btn-secondary" mat-button matStepperPrevious><i
                    class="material-icons reply">reply</i></button>
                <button type="button" (click)="validatePolicyHolder()" class=" btn-primary float-right"
                  mat-button><i class="material-icons fa fa-share"></i></button>
              </div>
            </mat-step>



            <mat-step *ngIf="isCarInsurance" completed="step3">
              <ng-template matStepLabel>{{'VEHICLE_POLICY_DETAILS' | translate}}</ng-template>
              <br>
              <div *ngIf="isNewType" class="row">
                <br>
                <br>
                      <div class="col-md-12">
                        <mat-card-title class="f-s-18">{{'EXISTING_VEHICLES' | translate}}</mat-card-title>

                        <arni-autocomplete [disabled]="!haveVehicles" #vehiclesComponent displayField="VehicleTypeModelChassis"
                          name="Vehicles" id="Vehicles" (onChange)="onSelectedVehicle($event)" [items]="allVehiclesInInsurance"
                          [selectedItem]="selectedValue" placeholder="{{'VEHICLES' | translate}}">
                        </arni-autocomplete>
                      </div>
                      </div>

              <br>
              <div class="row m-t-5">
                <div class="col-md-12">
                  <mat-card-title class="f-s-18" *ngIf="isNewType && !disableFieldsForVehicle">{{'NEW_VEHICLE' | translate}}
                  </mat-card-title>
                  <mat-form-field>
                    <mat-select required [disabled]="!enableFieldsForUpdate || disableFieldsForVehicle"
                      (selectionChange)="onVehicleTypeChange($event)" placeholder="{{'VEHICLE_TYPE' | translate}}"
                      type="text" #VehicleType="ngModel" [(ngModel)]="vehicle.VehicleType" name="VehicleType"
                      id="VehicleType">
                      <mat-option *ngFor="let type of VehicleTypes" [value]="type.value">
                        {{VehicleTypes[type.value].name | uppercase | translate}}
                      </mat-option>
                    </mat-select>
                  </mat-form-field>
                  <div *ngFor="let err of validationErrors?.VehicleType">
                    <span class="help-block text-danger">{{ err }}</span>
                  </div>
                </div>
              </div>

              <div class="row">
                <div class="col-md-11">
                  <arni-autocomplete #vehicleTypeModelComponent required
                    [disabled]="!enableFieldsForUpdate || disableFieldsForVehicle" displayField="TypeModel" name="VehicleTypeModel"
                    id="VehicleTypeModel" [items]="vehicleTypesModels" [selectedItem]="selectedVehicleTypeModel"
                    (onChange)="onSelectedVehicleTypeModel($event)" placeholder="{{'TYPE_AND_BRAND' | translate}} *">
                  </arni-autocomplete>
                </div>

                <div class="col-md-1">
                  <button *ngIf="isNewType" [disabled]="disableFieldsForVehicle"
                    matTooltip="{{'NEW_TYPE_AND_MODEL_OF_VEHICLE' | translate}}" type="button" mat-raised-button
                    color="primary" class="float-right outline-unset" (click)="addNewVehicleTypeAndModel()">
                    <i class="material-icons">add</i>
                  </button>
                </div>
              </div>
              <div *ngFor="let err of validationErrors?.VehicleTypeModel">
                <span class="help-block text-danger"> {{ err }}</span>
              </div>

              <mat-form-field class="example-full-width">
                <input required onkeypress="return (event.charCode != 32)" mask="A99-A-999"
                  oninput="validity.valid||(value='');" [disabled]="!enableFieldsForUpdate || disableFieldsForVehicle" type="text"
                  #LicensePlate="ngModel" [(ngModel)]="vehicle.LicensePlate" name="LicensePlate" matInput
                  placeholder="{{'LICENSE_PLATE' | translate}}">
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.LicensePlate">
                <span class="help-block text-danger"> {{ err }}</span>
              </div>

              <mat-form-field class="example-full-width">
                <input required [disabled]="!enableFieldsForUpdate || disableFieldsForVehicle"
                  oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);this.value = Math.abs(this.value);"
                  maxlength="4" type="number" #ProductionYear="ngModel" [(ngModel)]="vehicle.ProductionYear"
                  name="ProductionYear" matInput placeholder="{{'PRODUCTION_YEAR' | translate}}">
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.ProductionYear">
                <span class="help-block text-danger"> {{ err }}</span>
              </div>

              <mat-form-field class="example-full-width">
                <input required min="0" [disabled]="!enableFieldsForUpdate || disableFieldsForVehicle"
                  oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);this.value = Math.abs(this.value);"
                  maxlength="3" type="number" #EnginePower="ngModel" [(ngModel)]="vehicle.EnginePower"
                  name="EnginePower" matInput placeholder="{{'ENGINE_POWER' | translate}}">
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.EnginePower">
                <span class="help-block text-danger"> {{ err }}</span>
              </div>

              <mat-form-field class="example-full-width">
                <input required min="0" [disabled]="!enableFieldsForUpdate || disableFieldsForVehicle"
                  oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);this.value = Math.abs(this.value);"
                  maxlength="4" type="number" #EngineDisplacement="ngModel" [(ngModel)]="vehicle.EngineDisplacement"
                  name="EngineDisplacement" matInput placeholder="{{'ENGINE_DISPLACEMENT' | translate}}">
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.EngineDisplacement">
                <span class="help-block text-danger"> {{ err }}</span>
              </div>

              <mat-form-field *ngIf="vehicleInsurance" class="example-full-width">
                <input min="0" [disabled]="!enableFieldsForUpdate || disableFieldsForVehicle"
                  oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);this.value = Math.abs(this.value);"
                  maxlength="6" type="number" #LoadCapacity="ngModel" [(ngModel)]="vehicle.LoadCapacity"
                  name="LoadCapacity" matInput placeholder="{{'LOAD_CAPACITY' | translate}}">
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.LoadCapacity">
                <span class="help-block text-danger"> {{ err }}</span>
              </div>

              <mat-form-field *ngIf="vehicleInsurance" class="example-full-width">
                <input min="0" [disabled]="!enableFieldsForUpdate || disableFieldsForVehicle"
                  oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);this.value = Math.abs(this.value);"
                  maxlength="6" type="number" #MaxPermissibleMass="ngModel" [(ngModel)]="vehicle.MaxPermissibleMass"
                  name="MaxPermissibleMass" matInput placeholder="{{'MAXIMUM_PERMISSIBLE_MASS' | translate}}">
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.MaxPermissibleMass">
                <span class="help-block text-danger"> {{ err }}</span>
              </div>

              <mat-form-field class="example-full-width">
                <input required min="0" [disabled]="!enableFieldsForUpdate || disableFieldsForVehicle"
                  oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);this.value = Math.abs(this.value);"
                  maxlength="2" type="number" #SeatsNumber="ngModel" [(ngModel)]="vehicle.SeatsNumber"
                  name="SeatsNumber" matInput placeholder="{{'NUMBER_OF_SEATS' | translate}}">
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.SeatsNumber">
                <span class="help-block text-danger"> {{ err }}</span>
              </div>

              <mat-form-field class="example-full-width">
                <mat-select [disabled]="!enableFieldsForUpdate || disableFieldsForVehicle" placeholder="{{'FUEL_TYPE' | translate}}" type="text"
                  #FuelType="ngModel" [(ngModel)]="vehicle.FuelType" name="FuelType" id="FuelType">
                  <mat-option [value]="null">BEZ VRSTE GORIVA</mat-option>
                  <mat-option *ngFor="let enum of FuelTypes" [value]="enum.value">
                    {{enum.name | uppercase | translate}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.FuelType">
                <span class="help-block text-danger">{{ err }}</span>
              </div>
              <div class="row">
                <div class="col-md-11">
                  <arni-autocomplete #colorComponent
                  [disabled]="!enableFieldsForUpdate || disableFieldsForVehicle" displayField="ColorName" name="Color"
                  id="Color" [items]="colors" [selectedItem]="selectedColor"
                  (onChange)="onSelectedColor($event)" placeholder="{{'VEHICLE_COLOR' | translate}}">
                </arni-autocomplete>
                </div>
                <div class="col-md-1">
                  <button *ngIf="isNewType" [disabled]="disableFieldsForVehicle"
                    matTooltip="{{'NEW_COLOR_OF_VEHICLE' | translate}}" type="button" mat-raised-button
                    color="primary" class="float-right outline-unset" (click)="addNewColor()">
                    <i class="material-icons">add</i>
                  </button>
                </div>
              </div>
              <div *ngFor="let err of validationErrors?.Color">
                <span class="help-block text-danger"> {{ err }}</span>
              </div>

              <mat-form-field class="example-full-width">
                <input required onkeypress="return (event.charCode != 32)"
                maxlength="17"
                  [disabled]="!enableFieldsForUpdate || disableFieldsForVehicle" type="text" #ChassisNumber="ngModel"
                  [(ngModel)]="vehicle.ChassisNumber" name="ChassisNumber" matInput
                  placeholder="{{'CHASSIS_NUMBER' | translate}}">
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.ChassisNumber">
                <span class="help-block text-danger"> {{ err }}</span>
              </div>

              <mat-form-field class="example-full-width">
                <input required onkeypress="return (event.charCode != 32)" oninput="validity.valid||(value='');"
                  [disabled]="!enableFieldsForUpdate || disableFieldsForVehicle" type="text" #EngineNumber="ngModel"
                  [(ngModel)]="vehicle.EngineNumber" name="EngineNumber" matInput
                  placeholder="{{'ENGINE_NUMBER' | translate}}">
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.EngineNumber">
                <span class="help-block text-danger"> {{ err }}</span>
              </div>

              <div>
                <button type="button" class="btn btn-secondary" mat-button matStepperPrevious><i
                    class="material-icons reply">reply</i></button>
                <button type="button" (click)="validateVehiclePolicy()" class="btn btn-primary float-right"
                  mat-button><i class="material-icons fa fa-share"></i></button>
              </div>
            </mat-step>



            <mat-step completed="step4">
              <ng-template matStepLabel>{{'FINANCIAL_ELEMENTS_REVENUES' | translate}}</ng-template>
              <mat-form-field class="example-full-width">
                <input [disabled]="!enableFieldsForUpdate" type="number" min="0" required
                  maxlength="6"
                  matInput
                  #Price="ngModel" [(ngModel)]="policy.Price" name="Price" value="policy.Price" (ngModelChange)="calculateTotalPremium()"
                  placeholder="{{'POLICY_PRICE' | translate}}">
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.Price">
                <span class="help-block text-danger">{{err}}</span>
              </div>

              <mat-form-field class="example-full-width">
                <input [disabled]="!enableFieldsForUpdate" min="0" required
                  maxlength="6"
                  type="number" #CarAccidentCompensation="ngModel" [(ngModel)]="policy.CarAccidentCompensation"
                  name="CarAccidentCompensation" matInput placeholder="{{'CAR_ACCIDENT_COMPENSATION' | translate}}"
                  (ngModelChange)="calculateTotalPremium()">
              </mat-form-field>
              <div *ngFor="let err of validationErrors?.CarAccidentCompensation">
                <span class="help-block text-danger"> {{ err }}</span>
              </div>

              <mat-form-field>
                <input [disabled]="true" min="0"
                  type="number" #MainTotal [(ngModel)]="policy.TotalPremium"
                  name="FirstTotal" matInput placeholder="{{'TOTAL_PREMIUM' | translate}}">
              </mat-form-field>

              <mat-form-field class="example-full-width">
                <mat-select required [disabled]="!enableFieldsForUpdate" required
                  (selectionChange)="onSelectedTechnicalInspection($event)" [(ngModel)]="selectedTechnicalInspection" id="TechnicalInspection"
                  name="TechnicalInspection" placeholder="{{'TECHNICAL_INSPECTIONS_UPPER' | translate}}">
                  <mat-option *ngFor="let technicalInspection of technicalInspections" [value]="technicalInspection">
                    {{technicalInspection.Name}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
          <div *ngFor="let err of validationErrors?.TechnicalInspection">
            <span class="help-block text-danger"> {{ err }}</span>
          </div>

          <mat-form-field *ngIf="isAdmin">
            <input min="0"
              type="number" #Other [(ngModel)]="policy.Other"
              name="Other" matInput placeholder="{{'OTHER' | translate}}">
          </mat-form-field>
              <br>
              <br>
              <div>
                <button (click)="goToPrevious(stepper)" type="button" class="btn btn-secondary" mat-button><i
                    class="material-icons reply">reply</i></button>

                <button type="button" (click)="validateFinancialExpenses()" class="btn btn-primary float-right" mat-button><i
                    class="material-icons fa fa-share"></i></button>
              </div>
            </mat-step>



            <mat-step completed="step5">
              <ng-template matStepLabel>{{'EXPENSES' | translate}}</ng-template>

             <mat-checkbox [disabled]="!isNewType" [(ngModel)]="policy.DirectReverse" color="primary" class="m-r-10" name="range" (change)="showPercentField($event)">{{'DIRECT_RETURN' | translate}}</mat-checkbox>
             <mat-form-field class="example-full-width">
              <mat-select required [disabled]="!isNewType || !showPercent"
                (selectionChange)="onSelectedPaymentMethod($event)" [(ngModel)]="selectedPaymentMethod" id="selectedPaymentMethod"
                name="selectedPaymentMethod" placeholder="{{'PAYMENT_METHODS' | translate}}">
                <mat-option *ngFor="let paymentMethod of paymentMethods" [value]="paymentMethod">
                  {{paymentMethod}}
                </mat-option>
              </mat-select>
            </mat-form-field>

              <div *ngIf="showVoucher" class="row">
                <div class="col-md-12">
                  <arni-autocomplete #partnerComponent required name="Partner"
                  [disabled]="!isNewType || !policy.DirectReverse" displayField="Name"
                  id="Partner" [items]="partners" [selectedItem]="selectedPartner" (keydown)="clearFieldsForPartner($event)"
                  (onChange)="onSelectedPartner($event)" placeholder="{{'PARTNER_J' | translate}} *">
                </arni-autocomplete>

                <div *ngFor="let err of validationErrors?.Partner">
                  <span class="help-block text-danger"> {{ err }}</span>
                </div>

                <mat-form-field *ngIf="isNewType" class="example-full-width">
                  <mat-select name="Voucher" [disabled]="disableVouchers || !policy.DirectReverse"
                    (selectionChange)="onSelectedVoucher($event)" [(ngModel)]="selectedVoucher" id="Voucher"
                     placeholder="{{'VOUCHER_NUMBER' | translate}}">
                    <mat-option *ngFor="let voucher of vouchers" [value]="voucher">
                      {{voucher.Number}}
                    </mat-option>
                  </mat-select>
                </mat-form-field>

                <mat-form-field *ngIf="!isNewType">
                  <input required [disabled]="!isNewType"
                    type="text" #VoucherSelect [(ngModel)]="voucherNumber" id="VoucherSelected"
                    name="VoucherSelect" matInput placeholder="{{'VOUCHER_NUMBER' | translate}}">
                </mat-form-field>

                <div *ngFor="let err of validationErrors?.Voucher">
                  <span class="help-block text-danger"> {{ err }}</span>
                </div>
              </div>
            </div>

              <div *ngIf="showTotal" class="row">
                <div class="col-md-12">
                  <mat-form-field>
                    <input required [disabled]="!enableFieldsForUpdate" min="0" (ngModelChange)="calcualteMainTotal()"
                      type="number" #Percent [(ngModel)]="policy.Percent" id="Percent" (keydown)="clearFields($event)"
                      name="Percent" matInput placeholder="{{'PERCENT' | translate}}">
                  </mat-form-field>

                    <mat-form-field>
                        <input required [disabled]="!enableFieldsForUpdate" min="0" (ngModelChange)="calculatePercent()"
                          type="number" #FirstTotal [(ngModel)]="policy.MainTotal" id="MainTotal" (keydown)="clearFields($event)"
                          name="MainTotal" matInput placeholder="{{'MAIN_TOTAL' | translate}}">
                      </mat-form-field>
                </div>
              </div>

              <mat-form-field class="example-full-width" *ngIf="isAdmin">
                <mat-select required
                  (selectionChange)="onSelectedAdminTechnicalInspection($event)" [(ngModel)]="adminTechnicalInspection" id="AdminTechnicalInspection"
                  name="AdminTechnicalInspection" placeholder="{{'TECHNICAL_INSPECTIONS_UPPER' | translate}}">
                  <mat-option *ngFor="let adminTechnicalInspection of technicalInspections" [value]="adminTechnicalInspection">
                    {{adminTechnicalInspection.Name}}
                  </mat-option>
                </mat-select>
              </mat-form-field>
        <div *ngFor="let err of validationErrors?.AdminTechnicalInspection">
          <span class="help-block text-danger"> {{ err }}</span>
        </div>

              <arni-autocomplete #userComponent *ngIf="isAdmin" required
                     displayField="FullName" name="Agent"
                    id="Agent" [items]="agents" [selectedItem]="selectedSupplier"
                    (onChange)="onSelectedSupplier($event)" placeholder="{{'USER_AGENT' | translate}} *">
                  </arni-autocomplete>
                  <div *ngFor="let err of validationErrors?.Agent">
                    <span class="help-block text-danger"> {{ err }}</span>
                  </div>

            <mat-form-field *ngIf="isAdmin">
              <input required min="0" (ngModelChange)="calcualteSecondMainTotal()"
                type="number" #SecondPercent [(ngModel)]="policy.SecondPercent" (keydown)="secondClearFields($event)"
                name="SecondPercent" matInput placeholder="{{'PERCENT' | translate}}">
            </mat-form-field>
            <div *ngFor="let err of validationErrors?.SecondPercent">
              <span class="help-block text-danger"> {{ err }}</span>
            </div>

            <mat-form-field *ngIf="isAdmin">
              <input required min="0" (ngModelChange)="calculateSecondPercent()"
                type="number" #SecondTotal [(ngModel)]="policy.SecondMainTotal" (keydown)="secondClearFields($event)"
                name="SecondMainTotal" matInput placeholder="{{'SECOND_MAIN_TOTAL' | translate}}">
            </mat-form-field>
            <div *ngFor="let err of validationErrors?.SecondMainTotal">
              <span class="help-block text-danger"> {{ err }}</span>
            </div>

              <br>
              <br>
            <div *ngIf="policyLogs.length>0">
              <div *ngxPermissionsOnly="['P_ENABLE_FIELDS']">
                <mat-card-title>{{'POLICY_LOGS' | translate}}</mat-card-title>
                <br>
                <br>
                <p-table #dt [value]="policyLogs" [responsive]="true" [paginator]="true" [rows]="10"
                  sortOrder="-1" [rowsPerPageOptions]="[10,20,30,40,50]" dataKey="Id" (onRowExpand)="rowExpand($event)" rowExpandMode="single">
                  <ng-template pTemplate="header">
                    <tr>
                      <th [pSortableColumn]="'AddedBy'" class="text-right width-100-px">
                        <i class="ui-sortable-column-icon pi pi-fw pi-sort"></i>
                        {{'UPDATE_BY' | translate}}
                      </th>
                      <th [pSortableColumn]="'Update'" class="text-right width-100-px">
                        <i class="ui-sortable-column-icon pi pi-fw pi-sort"></i>
                        {{'UPDATE_DATE' | translate}}
                      </th>
                      <th [pSortableColumn]="'MainOffice'" class="text-right width-100-px">
                        <i class="ui-sortable-column-icon pi pi-fw pi-sort"></i>
                        {{'MAIN_OFFICE' | translate}}
                      </th>
                      <th [pSortableColumn]="'Insurance'" class="text-right width-100-px">
                        <i class="ui-sortable-column-icon pi pi-fw pi-sort"></i>
                        {{'INSURANCE_NAME' | translate}}
                      </th>
                      <th [pSortableColumn]="'PolicyNumber'" class="text-right width-100-px">
                        <i class="ui-sortable-column-icon pi pi-fw pi-sort"></i>
                        {{'POLICY_NUMBER' | translate}}
                      </th>
                      <th class="w-10">
                      </th>
                    </tr>
                  </ng-template>
                  <ng-template  pTemplate="body" let-policyLog let-expanded="expanded" let-i="rowIndex" let-columns="columns">
                    <tr>
                      <td class="text-right"><span class="ui-column-title text-left float-left">{{ 'ADDED_BY' | translate }}</span><span
                        class="float-right">{{policyLog.AddedBy || '-'}}</span></td>
                      <td class="text-right"><span class="ui-column-title text-left float-left">{{ 'UPDATE_DATE' | translate }}</span><span
                        class="float-right">{{policyLog.Update | dateTimeFormat}}</span></td>
                      <td class="text-right"><span
                        class="ui-column-title text-left float-left">{{ 'MAIN_OFFICE' | translate }}</span><span
                        class="float-right">{{policyLog.MainOffice || '-'}}</span></td>
                    <td class="text-right"><span
                        class="ui-column-title text-left float-left">{{ 'INSURANCE_NAME' | translate }}</span><span
                        class="float-right">{{policyLog.Insurance || '-'}}</span></td>

                    <td class="text-right"><span class="ui-column-title text-left float-left">{{ 'POLICY_NUMBER' | translate }}</span><span
                        class="float-right">{{policyLog.PolicyNumber || '-'}}</span></td>
                        <td>
                          <a  class="theme-color" href="#" [pRowToggler]="policyLog">
                            <i [ngClass]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></i>
                          </a>
                        </td>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="rowexpansion" let-columns="columns">
                    <mat-card class="width-1515">
                      <mat-card-content>
                          <table class="example-full-width">


                            <div class="row" *ngIf="policyLogExpandData.InsuranceType!=null || policyLogExpandData.GreenCard!=null ||
                            policyLogExpandData.PolicyExpiration!=null || policyLogExpandData.PolicyBegin!=null || policyLogExpandData.Created!=null">
                              <div class="col-md-6">
                                <h5><b>Stari podaci o polisi i zelenom kartonu</b></h5>
                                <br>
                                <tr *ngIf="policyLogExpandData.InsuranceType!=null && oldDataExpand.InsuranceType!=policyLogExpandData.InsuranceType">
                                  <td class="width-295"><mat-form-field class="example-full-width td">
                                    <input [disabled]="true" matInput required type="text" #InsuranceTypeOld="ngModel"
                                      [(ngModel)]="oldDataExpand.InsuranceType" name="InsuranceTypeOld" placeholder="{{'INSURANCE_TYPE' | translate}}">
                                  </mat-form-field></td>
                                </tr>

                                <tr *ngIf="policyLogExpandData.GreenCard!=null && oldDataExpand.GreenCard!=policyLogExpandData.GreenCard">
                                  <td class="width-295"><mat-form-field class="example-full-width td">
                                    <input [disabled]="true" matInput required type="text" #GreenCardOld="ngModel"
                                      [(ngModel)]="oldDataExpand.GreenCard" name="GreenCardOld" placeholder="{{'GREEN_CARDS' | translate}}">
                                  </mat-form-field></td>
                                </tr>

                                <tr *ngIf="policyLogExpandData.Created!=null">
                                  <td class="width-295">
                                    <label>DATUM IZDAVANJA: {{oldDataExpand.Created | dateFormat}}</label>
                                  </td>
                                </tr>

                                <tr *ngIf="policyLogExpandData.PolicyBegin!=null">
                                  <td class="width-295">
                                    <label>POČETAK POLISE: {{oldDataExpand.PolicyBegin | dateFormat}}</label>
                                  </td>
                                </tr>

                                <tr *ngIf="policyLogExpandData.PolicyExpiration!=null">
                                  <td class="width-295">
                                    <label>ISTEK POLISE: {{oldDataExpand.PolicyExpiration | dateFormat}}</label>
                                  </td>
                                </tr>
                              </div>
                              <div class="col-md-6">
                                <h5><b>Izmijenjeni podaci o polisi i zelenom kartonu</b></h5>
                                <br>
                                <tr *ngIf="policyLogExpandData.InsuranceType!=null">
                                  <td class="width-295"><mat-form-field class="example-full-width td">
                                    <input [disabled]="true" matInput required type="text" #InsuranceTypeNew="ngModel"
                                      [(ngModel)]="policyLogExpandData.InsuranceType" name="InsuranceTypeNew" placeholder="{{'INSURANCE_TYPE' | translate}}">
                                  </mat-form-field></td>
                                </tr>

                                <tr *ngIf="policyLogExpandData.GreenCard!=null">
                                  <td class="width-295"><mat-form-field class="example-full-width td">
                                    <input [disabled]="true" matInput required type="text" #GreenCardNew="ngModel"
                                      [(ngModel)]="policyLogExpandData.GreenCard" name="GreenCardNew" placeholder="{{'GREEN_CARDS' | translate}}">
                                  </mat-form-field></td>
                                </tr>

                                <tr *ngIf="policyLogExpandData.Created!=null">
                                  <td class="width-295">
                                    <label>DATUM IZDAVANJA: {{policyLogExpandData.Created | dateFormat}}</label>
                                  </td>
                                </tr>

                                <tr *ngIf="policyLogExpandData.PolicyBegin!=null">
                                  <td class="width-295">
                                    <label>POČETAK POLISE: {{policyLogExpandData.PolicyBegin | dateFormat}}</label>
                                  </td>
                                </tr>

                                <tr *ngIf="policyLogExpandData.PolicyExpiration!=null">
                                  <td class="width-295">
                                    <label>ISTEK POLISE: {{policyLogExpandData.PolicyExpiration | dateFormat}}</label>
                                  </td>
                                </tr>
                              </div>
                            </div>
                            <hr *ngIf="policyLogExpandData.InsuranceType!=null || policyLogExpandData.GreenCard!=null ||
                            policyLogExpandData.PolicyExpiration!=null || policyLogExpandData.PolicyBegin!=null || policyLogExpandData.Created!=null">


                            <div class="row" *ngIf="policyLogExpandData.FirstName!=null || policyLogExpandData.LastName!=null || policyLogExpandData.Address!=null || policyLogExpandData.City!=null
                            || policyLogExpandData.PersonalIdentificationNumber!=null || policyLogExpandData.CompanyName != null">
                              <div class="col-md-6">
                                <h5><b>Stari podaci o osiguraniku</b></h5>
                                <br>
                                <tr *ngIf="policyLogExpandData.CompanyName!=null && oldDataExpand.CompanyName != policyLogExpandData.CompanyName">
                                  <td class="width-295"><mat-form-field class="example-full-width td">
                                    <input [disabled]="true" matInput required type="text" #OldCompanyName="ngModel"
                                      [(ngModel)]="oldDataExpand.CompanyName" name="OldCompanyName" placeholder="{{'COMPANY' | translate}}">
                                  </mat-form-field></td>
                                </tr>
                                <tr *ngIf="policyLogExpandData.FirstName!=null && oldDataExpand.FirstName!=policyLogExpandData.FirstName">
                                  <td class="width-295"><mat-form-field class="example-full-width td">
                                    <input [disabled]="true" matInput required type="text" #FirstNameOld="ngModel"
                                      [(ngModel)]="oldDataExpand.FirstName" name="FirstNameOld" placeholder="{{'FIRST_NAME' | translate}}">
                                  </mat-form-field></td>
                                </tr>

                                <tr *ngIf="policyLogExpandData.LastName!=null &&  oldDataExpand.LastName!=policyLogExpandData.LastName">
                                  <td class="width-295"><mat-form-field class="example-full-width td">
                                    <input [disabled]="true" matInput required type="text" #LastNameLogOld="ngModel"
                                      [(ngModel)]="oldDataExpand.LastName" name="LastNameLogOld" placeholder="{{'LAST_NAME' | translate}}">
                                  </mat-form-field></td>
                                </tr>

                                  <tr *ngIf="policyLogExpandData.PersonalIdentificationNumber!=null && oldDataExpand.PersonalIdentificationNumber!=policyLogExpandData.PersonalIdentificationNumber">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #PersonalIdentificationLogOld="ngModel"
                                        [(ngModel)]="oldDataExpand.PersonalIdentificationNumber" name="PersonalIdentificationLogOld" placeholder="{{'PERSONAL_IDENTIFICATION_NUMBER' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.Address!=null && oldDataExpand.Address!=policyLogExpandData.Address">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #AddressLogOld="ngModel"
                                        [(ngModel)]="oldDataExpand.Address" name="AddressLogOld" placeholder="{{'ADDRESS' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.City!=null && oldDataExpand.City!=policyLogExpandData.City">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #CityLogOld="ngModel"
                                        [(ngModel)]="oldDataExpand.City" name="CityLogOld" placeholder="{{'CITY' | translate}}">
                                    </mat-form-field></td>
                                  </tr>
                              </div>


                              <div class="col-md-6">
                                <h5><b>Izmijenjeni podaci o osiguraniku</b></h5>
                                <br>
                                <tr *ngIf="policyLogExpandData.CompanyName!=null">
                                  <td class="width-295"><mat-form-field class="example-full-width td">
                                    <input [disabled]="true" matInput required type="text" #NewCompanyName="ngModel"
                                      [(ngModel)]="policyLogExpandData.CompanyName" name="NewCompanyName" placeholder="{{'COMPANY' | translate}}">
                                  </mat-form-field></td>
                                </tr>
                                <tr *ngIf="policyLogExpandData.FirstName!=null">
                                  <td class="width-295"><mat-form-field class="example-full-width td">
                                    <input [disabled]="true" matInput required type="text" #FirstNameNew="ngModel"
                                      [(ngModel)]="policyLogExpandData.FirstName" name="FirstNameNew" placeholder="{{'FIRST_NAME' | translate}}">
                                  </mat-form-field></td>
                                </tr>

                                <tr *ngIf="policyLogExpandData.LastName!=null">
                                  <td class="width-295"><mat-form-field class="example-full-width td">
                                    <input [disabled]="true" matInput required type="text" #LastNameLogNew="ngModel"
                                      [(ngModel)]="policyLogExpandData.LastName" name="LastNameLogNew" placeholder="{{'LAST_NAME' | translate}}">
                                  </mat-form-field></td>
                                </tr>

                                  <tr *ngIf="policyLogExpandData.PersonalIdentificationNumber!=null">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #PersonalIdentificationLogNew="ngModel"
                                        [(ngModel)]="policyLogExpandData.PersonalIdentificationNumber" name="PersonalIdentificationLogNew" placeholder="{{'PERSONAL_IDENTIFICATION_NUMBER' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.Address!=null">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #AddressLogNew="ngModel"
                                        [(ngModel)]="policyLogExpandData.Address" name="AddressLogNew" placeholder="{{'ADDRESS' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.City!=null">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #CityLogNew="ngModel"
                                        [(ngModel)]="policyLogExpandData.City" name="CityLogNew" placeholder="{{'CITY' | translate}}">
                                    </mat-form-field></td>
                                  </tr>
                              </div>
                            </div>
                            <hr *ngIf="policyLogExpandData.FirstName!=null || policyLogExpandData.LastName!=null || policyLogExpandData.Address!=null || policyLogExpandData.City!=null
                            || policyLogExpandData.PersonalIdentificationNumber!=null || policyLogExpandData.CompanyName != null">



                            <div class="row" *ngIf="isCarInsurance && (policyLogExpandData.VehicleTypeModel!=null ||
                             policyLogExpandData.VehicleType!=null || policyLogExpandData.LicensePlate!=null ||
                              policyLogExpandData.ProductionYear!=null || policyLogExpandData.Fuel!=null ||
                            policyLogExpandData.EnginePower!=null || policyLogExpandData.ChassisNumber!=null ||
                             policyLogExpandData.EngineNumber!=null || policyLogExpandData.Color!=null ||
                              policyLogExpandData.SeatsNumber!=null || policyLogExpandData.MaxPermissibleMass!=null ||
                               policyLogExpandData.LoadCapacity!=null)">
                              <div class="col-md-6">
                                <h5><b>Stari podaci o vozilu</b></h5>
                                <br>
                                <tr *ngIf="policyLogExpandData.VehicleTypeModel!=null && oldDataExpand.VehicleTypeModel!=policyLogExpandData.VehicleTypeModel">
                                  <td class="width-295"><mat-form-field class="example-full-width td">
                                    <input [disabled]="true" matInput required type="text" #CarModelOld="ngModel"
                                      [(ngModel)]="oldDataExpand.VehicleTypeModel" name="CarModelLogOld" placeholder="{{'CAR_MODEL' | translate}}">
                                  </mat-form-field></td>
                                </tr>

                                <tr *ngIf="policyLogExpandData.LicensePlate!=null && oldDataExpand.LicensePlate!=policyLogExpandData.LicensePlate">
                                  <td class="width-295"><mat-form-field class="example-full-width td">
                                    <input [disabled]="true" matInput required type="text" #LicensePlateLogOld="ngModel"
                                      [(ngModel)]="oldDataExpand.LicensePlate" name="LicensePlateLogOld" placeholder="{{'LICENSE_PLATE' | translate}}">
                                  </mat-form-field></td>
                                </tr>

                                  <tr *ngIf="policyLogExpandData.ProductionYear!=null && oldDataExpand.ProductionYear!=policyLogExpandData.ProductionYear">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #ProductionYearLogOld="ngModel"
                                        [(ngModel)]="oldDataExpand.ProductionYear" name="ProductionYearLogOld" placeholder="{{'PRODUCTION_YEAR' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.EnginePower!=null && oldDataExpand.EnginePower!=policyLogExpandData.EnginePower">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #EnginePowerLogOld="ngModel"
                                        [(ngModel)]="oldDataExpand.EnginePower" name="EnginePowerLogOld" placeholder="{{'ENGINE_POWER' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.ChassisNumber!=null && oldDataExpand.ChassisNumber!=policyLogExpandData.ChassisNumber">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #ChassisNumberLogOld="ngModel"
                                        [(ngModel)]="oldDataExpand.ChassisNumber" name="ChassisNumberLogOld" placeholder="{{'CHASSIS_NUMBER' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.EngineNumber!=null && oldDataExpand.EngineNumber!=policyLogExpandData.EngineNumber">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #EngineNumberLogOld="ngModel"
                                        [(ngModel)]="oldDataExpand.EngineNumber" name="EngineNumberLogOld" placeholder="{{'ENGINE_NUMBER' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.EngineDisplacement!=null && oldDataExpand.EngineDisplacement!=policyLogExpandData.EngineDisplacement">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #EngineDisplacementLogOld="ngModel"
                                        [(ngModel)]="oldDataExpand.EngineDisplacement" name="EngineDisplacementLogOld" placeholder="{{'ENGINE_DISPLACEMENT' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="vehicleInsurance && policyLogExpandData.LoadCapacity!=null && oldDataExpand.LoadCapacity!=policyLogExpandData.LoadCapacity">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #LoadCapacityLogOld="ngModel"
                                        [(ngModel)]="oldDataExpand.LoadCapacity" name="LoadCapacityLogOld" placeholder="{{'LOAD_CAPACITY' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="vehicleInsurance && policyLogExpandData.MaxPermissibleMass!=null && oldDataExpand.MaxPermissibleMass!=policyLogExpandData.MaxPermissibleMass">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #MaxPermissibleMassLogOld="ngModel"
                                        [(ngModel)]="oldDataExpand.MaxPermissibleMass" name="MaxPermissibleMassLogOld" placeholder="{{'MAXIMUM_PERMISSIBLE_MASS' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.SeatsNumber!=null && oldDataExpand.SeatsNumber!=policyLogExpandData.SeatsNumber">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #SeatsNumberLogOld="ngModel"
                                        [(ngModel)]="oldDataExpand.SeatsNumber" name="SeatsNumberLogOld" placeholder="{{'NUMBER_OF_SEATS' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.Color!=null && oldDataExpand.Color!=policyLogExpandData.Color">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #ColorLogOld="ngModel"
                                        [(ngModel)]="oldDataExpand.Color" name="ColorLogOld" placeholder="{{'COLOR' | translate}}">
                                    </mat-form-field></td>
                                  </tr>
                              </div>

                              <div class="col-md-6">
                                <h5><b>Izmijenjeni podaci o vozilu</b></h5>
                                <br>
                                <tr *ngIf="policyLogExpandData.VehicleTypeModel!=null">
                                  <td class="width-295"><mat-form-field class="example-full-width td">
                                    <input [disabled]="true" matInput required type="text" #CarModel="ngModel"
                                      [(ngModel)]="policyLogExpandData.VehicleTypeModel" name="CarModelLog" placeholder="{{'CAR_MODEL' | translate}}">
                                  </mat-form-field></td>
                                </tr>

                                <tr *ngIf="policyLogExpandData.LicensePlate!=null">
                                  <td class="width-295"><mat-form-field class="example-full-width td">
                                    <input [disabled]="true" matInput required type="text" #LicensePlateLog="ngModel"
                                      [(ngModel)]="policyLogExpandData.LicensePlate" name="LicensePlateLog" placeholder="{{'LICENSE_PLATE' | translate}}">
                                  </mat-form-field></td>
                                </tr>

                                  <tr *ngIf="policyLogExpandData.ProductionYear!=null">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #ProductionYearLog="ngModel"
                                        [(ngModel)]="policyLogExpandData.ProductionYear" name="ProductionYearLog" placeholder="{{'PRODUCTION_YEAR' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.EnginePower!=null">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #EnginePowerLog="ngModel"
                                        [(ngModel)]="policyLogExpandData.EnginePower" name="EnginePowerLog" placeholder="{{'ENGINE_POWER' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.ChassisNumber!=null">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #ChassisNumberLog="ngModel"
                                        [(ngModel)]="policyLogExpandData.ChassisNumber" name="ChassisNumberLog" placeholder="{{'CHASSIS_NUMBER' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.EngineNumber!=null">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #EngineNumberLog="ngModel"
                                        [(ngModel)]="policyLogExpandData.EngineNumber" name="EngineNumberLog" placeholder="{{'ENGINE_NUMBER' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.EngineDisplacement!=null">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #EngineDisplacementLog="ngModel"
                                        [(ngModel)]="policyLogExpandData.EngineDisplacement" name="EngineDisplacementLog" placeholder="{{'ENGINE_DISPLACEMENT' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="vehicleInsurance && policyLogExpandData.LoadCapacity!=null">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #LoadCapacityLog="ngModel"
                                        [(ngModel)]="policyLogExpandData.LoadCapacity" name="LoadCapacityLog" placeholder="{{'LOAD_CAPACITY' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="vehicleInsurance && policyLogExpandData.MaxPermissibleMass!=null">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #MaxPermissibleMassLog="ngModel"
                                        [(ngModel)]="policyLogExpandData.MaxPermissibleMass" name="MaxPermissibleMassLog" placeholder="{{'MAXIMUM_PERMISSIBLE_MASS' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.SeatsNumber!=null">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #SeatsNumberLog="ngModel"
                                        [(ngModel)]="policyLogExpandData.SeatsNumber" name="SeatsNumberLog" placeholder="{{'NUMBER_OF_SEATS' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.Color!=null">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #ColorLog="ngModel"
                                        [(ngModel)]="policyLogExpandData.Color" name="ColorLog" placeholder="{{'COLOR' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                              </div>
                            </div>
                              <hr *ngIf="isCarInsurance && (policyLogExpandData.VehicleTypeModel!=null ||
                              policyLogExpandData.VehicleType!=null || policyLogExpandData.LicensePlate!=null ||
                               policyLogExpandData.ProductionYear!=null || policyLogExpandData.Fuel!=null ||
                             policyLogExpandData.EnginePower!=null || policyLogExpandData.ChassisNumber!=null ||
                              policyLogExpandData.EngineNumber!=null || policyLogExpandData.Color!=null ||
                               policyLogExpandData.SeatsNumber!=null || policyLogExpandData.MaxPermissibleMass!=null ||
                                policyLogExpandData.LoadCapacity!=null)">


                              <div class="row" *ngIf="policyLogExpandData.Price!=null || policyLogExpandData.CarAccidentCompensation!=null ||
                              policyLogExpandData.TotalPremium!=null || policyLogExpandData.Other!=null || policyLogExpandData.TechnicalInspection!=null">
                                <div class="col-md-6">
                                  <h5><b>Stari podaci o prihodima</b></h5>
                                <br>
                                <tr *ngIf="policyLogExpandData.Price!=null && oldDataExpand.Price!=policyLogExpandData.Price">
                                  <td class="width-295"><mat-form-field class="example-full-width td">
                                    <input [disabled]="true" matInput required type="text" #PriceOld="ngModel"
                                      [(ngModel)]="oldDataExpand.Price" name="PriceOld" placeholder="{{'POLICY_PRICE' | translate}}">
                                  </mat-form-field></td>
                                </tr>

                                <tr *ngIf="policyLogExpandData.CarAccidentCompensation!=null &&  oldDataExpand.CarAccidentCompensation!=policyLogExpandData.CarAccidentCompensation">
                                  <td class="width-295"><mat-form-field class="example-full-width td">
                                    <input [disabled]="true" matInput required type="text" #CarAccidentLogOld="ngModel"
                                      [(ngModel)]="oldDataExpand.CarAccidentCompensation" name="CarAccidentLogOld" placeholder="{{'CAR_ACCIDENT_COMPENSATION' | translate}}">
                                  </mat-form-field></td>
                                </tr>

                                  <tr *ngIf="policyLogExpandData.TotalPremium!=null && oldDataExpand.TotalPremium!=policyLogExpandData.TotalPremium">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #TotalPremiumLogOld="ngModel"
                                        [(ngModel)]="oldDataExpand.TotalPremium" name="PersonalIdentificationLogOld" placeholder="{{'TOTAL_PREMIUM' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.TechnicalInspection!=null && oldDataExpand.TechnicalInspection!=policyLogExpandData.TechnicalInspection">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #TechnicalInspectionLogOld="ngModel"
                                        [(ngModel)]="oldDataExpand.TechnicalInspection" name="TechLogOld" placeholder="{{'TECHNICAL_INSPECTION' | translate}}">
                                    </mat-form-field></td>
                                  </tr>


                                  <tr *ngIf="policyLogExpandData.Other!=null && oldDataExpand.Other!=policyLogExpandData.Other">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #OtherLogOld="ngModel"
                                        [(ngModel)]="oldDataExpand.Other" name="OtherLogOld" placeholder="{{'OTHER' | translate}}">
                                    </mat-form-field></td>
                                  </tr>
                                </div>

                                <div class="col-md-6">
                                  <h5><b>Izmijenjeni podaci o prihodima</b></h5>
                                  <br>
                                  <tr *ngIf="policyLogExpandData.Price!=null">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #PriceNew="ngModel"
                                        [(ngModel)]="policyLogExpandData.Price" name="PriceNew" placeholder="{{'POLICY_PRICE' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.CarAccidentCompensation!=null">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #CarAccidentLogNew="ngModel"
                                        [(ngModel)]="policyLogExpandData.CarAccidentCompensation" name="CarAccidentLogNew" placeholder="{{'CAR_ACCIDENT_COMPENSATION' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                    <tr *ngIf="policyLogExpandData.TotalPremium!=null">
                                      <td class="width-295"><mat-form-field class="example-full-width td">
                                        <input [disabled]="true" matInput required type="text" #TotalPremiumLogNew="ngModel"
                                          [(ngModel)]="policyLogExpandData.TotalPremium" name="PersonalIdentificationLogNew" placeholder="{{'TOTAL_PREMIUM' | translate}}">
                                      </mat-form-field></td>
                                    </tr>

                                    <tr *ngIf="policyLogExpandData.TechnicalInspection!=null">
                                      <td class="width-295"><mat-form-field class="example-full-width td">
                                        <input [disabled]="true" matInput required type="text" #TechnicalInspectionLogNew="ngModel"
                                          [(ngModel)]="policyLogExpandData.TechnicalInspection" name="TechLogNew" placeholder="{{'TECHNICAL_INSPECTION' | translate}}">
                                      </mat-form-field></td>
                                    </tr>


                                    <tr *ngIf="policyLogExpandData.Other!=null">
                                      <td class="width-295"><mat-form-field class="example-full-width td">
                                        <input [disabled]="true" matInput required type="text" #OtherLogNew="ngModel"
                                          [(ngModel)]="policyLogExpandData.Other" name="OtherLogNew" placeholder="{{'OTHER' | translate}}">
                                      </mat-form-field></td>
                                    </tr>
                                </div>
                              </div>
                              <hr *ngIf="policyLogExpandData.Price!=null || policyLogExpandData.CarAccidentCompensation!=null ||
                              policyLogExpandData.TotalPremium!=null || policyLogExpandData.Other!=null">



                              <div class="row" *ngIf="policyLogExpandData.Total!=null || policyLogExpandData.Percent!=null ||
                              policyLogExpandData.SecondTotal!=null || policyLogExpandData.SecondPercent!=null ||
                              policyLogExpandData.AdminTechnicalInspection!=null || policyLogExpandData.Agent!=null">
                                <div class="col-md-6">
                                  <h5><b>Stari podaci o rashodima</b></h5>
                                  <br>

                                  <tr *ngIf="policyLogExpandData.Total!=null && oldDataExpand.Total!=policyLogExpandData.Total">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #TotalOld="ngModel"
                                        [(ngModel)]="oldDataExpand.Total" name="TotalOld" placeholder="{{'MAIN_TOTAL' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.Percent!=null && oldDataExpand.Percent!=policyLogExpandData.Percent">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #PercentLogOld="ngModel"
                                        [(ngModel)]="oldDataExpand.Percent" name="PercentOldLog" placeholder="{{'PERCENT' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                    <tr *ngIf="policyLogExpandData.AdminTechnicalInspection!=null && oldDataExpand.AdminTechnicalInspection!=policyLogExpandData.AdminTechnicalInspection">
                                      <td class="width-295"><mat-form-field class="example-full-width td">
                                        <input [disabled]="true" matInput required type="text" #AdminTechnicalInspectionLogOld="ngModel"
                                          [(ngModel)]="oldDataExpand.AdminTechnicalInspection" name="AdminTechLogOld" placeholder="{{'TECHNICAL_INSPECTION' | translate}}">
                                      </mat-form-field></td>
                                    </tr>

                                    <tr *ngIf="policyLogExpandData.Agent!=null && oldDataExpand.Agent!=policyLogExpandData.Agent">
                                      <td class="width-295"><mat-form-field class="example-full-width td">
                                        <input [disabled]="true" matInput required type="text" #AgentLogOld="ngModel"
                                          [(ngModel)]="oldDataExpand.Agent" name="AgentLogOld" placeholder="{{'SUPPLIER' | translate}}">
                                      </mat-form-field></td>
                                    </tr>
                                </div>


                                <div class="col-md-6">
                                  <h5><b>Izmijenjeni podaci o rashodima</b></h5>
                                  <br>
                                  <tr *ngIf="policyLogExpandData.Total!=null">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #TotalNew="ngModel"
                                        [(ngModel)]="policyLogExpandData.Total" name="TotalNew" placeholder="{{'MAIN_TOTAL' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                  <tr *ngIf="policyLogExpandData.Percent!=null">
                                    <td class="width-295"><mat-form-field class="example-full-width td">
                                      <input [disabled]="true" matInput required type="text" #PercentLogNew="ngModel"
                                        [(ngModel)]="policyLogExpandData.Percent" name="PercentNewLog" placeholder="{{'PERCENT' | translate}}">
                                    </mat-form-field></td>
                                  </tr>

                                    <tr *ngIf="policyLogExpandData.AdminTechnicalInspection!=null">
                                      <td class="width-295"><mat-form-field class="example-full-width td">
                                        <input [disabled]="true" matInput required type="text" #AdminTechnicalInspectionLogNew="ngModel"
                                          [(ngModel)]="policyLogExpandData.AdminTechnicalInspection" name="AdminTechLogNew" placeholder="{{'TECHNICAL_INSPECTION' | translate}}">
                                      </mat-form-field></td>
                                    </tr>

                                    <tr *ngIf="policyLogExpandData.Agent!=null">
                                      <td class="width-295"><mat-form-field class="example-full-width td">
                                        <input [disabled]="true" matInput required type="text" #AgentLogNew="ngModel"
                                          [(ngModel)]="policyLogExpandData.Agent" name="AgentLogNew" placeholder="{{'SUPPLIER' | translate}}">
                                      </mat-form-field></td>
                                    </tr>

                                </div>
                              </div>
                        </table>
                      </mat-card-content>
                    </mat-card>
                </ng-template>
                </p-table>
                <br>
                <br>
                <br>
          </div>
        </div>
          <br>
              <br>
              <div>
                <button (click)="goToPrevious(stepper)" type="button" class="btn btn-secondary" mat-button><i
                    class="material-icons reply">reply</i></button>
                <button type="button" (click)="add(form)"  [disabled]="!form.valid" class="outline-unset float-right" mat-raised-button color="primary"
                    id="button-save"><i class="material-icons check">check</i>{{'SAVE' | translate}}</button>
              </div>
            </mat-step>
          </mat-horizontal-stepper>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</form>

